Please check code from 3 branches. 

